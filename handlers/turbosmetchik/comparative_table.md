# Сравнительная таблица методов обработки "Турбосметчик"

| Особенность                         | Турбосметчик-1                          | Турбосметчик-2                          | Турбосметчик-3                          |
|-----------------------------------|---------------------------------------|---------------------------------------|---------------------------------------|
| Основная логика                   | Базовая логика обработки Excel файла | Отличается маппингом 5-й колонки (Кол-во) на колонку N входа | Основан на логике "Новый Формат Смет" |
| Колонки вывода                   | №№ п/п, Шифр, Наименование, Ед.изм., Кол-во, ВСЕГО затрат | №№ п/п, Шифр, Наименование, Ед.изм., Кол-во, ВСЕГО затрат | №№ п/п, Шифр, Наименование, Ед.изм., Кол-во, ВСЕГО затрат |
| Маппинг входных колонок для "Кол-во" | M (индекс 12)                         | N (индекс 13)                         | M (индекс 12)                         |
| Маппинг входных колонок для "Ед.изм." | L (индекс 11)                         | L (индекс 11)                         | J (индекс 9)                          |
| Маппинг входных колонок для "Наименование" | D (индекс 3)                          | D (индекс 3)                          | E (индекс 4)                          |
| Обработка заголовков             | Проверка merge A-W, текст в колонке A | Аналогично v1                         | Проверка merge A-AB, текст в колонке A |
| Обработка футеров                | Проверка merge D-K, текст в колонке D | Аналогично v1                         | Проверка merge E-I, текст в колонке E |
| Обработка строк "Всего по позиции" | Проверка merge D-R, текст в колонке D | Аналогично v1                         | Проверка merge E-S, текст в колонке E |
| Координата итогов в футерах      | Колонка V (индекс 21)                 | Колонка V (индекс 21)                 | Колонка Z (индекс 25)                 |
| Обработка цены в строках item    | Проверка merge V-W, цена в колонке V  | Аналогично v1                         | Проверка merge Z-AB, цена в колонке Z |
| Обработка буфера item            | Аккумулирует item без цены, добавляет при появлении цены | Аналогично v1                         | Аналогично v1                         |
| Обработка строк с целочисленным номером | Проверка наличия цены в строке (merge V-W) | Аналогично v1                         | Проверка наличия цены в строке (merge Z-AB) |
| Обработка ошибок                | Обработка FileNotFoundError и общих исключений с логом | Аналогично v1                         | Аналогично v1                         |
